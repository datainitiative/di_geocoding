{% extends "admin/base_site.html" %}
{% load i18n admin_static bootstrapped_goodies_tags %}
{% load custom_filter %}{% load custom_tag %}
{% block title %}Home | MHC Dashboard{% endblock %}
{% block extrastyle %}
<style>
path {  stroke: #fff; }
path:hover {  opacity:0.9; }
rect:hover {  opacity:0.8; }
.axis {  font: 10px sans-serif; }
.legend tr{    border-bottom:1px solid grey; }
.legend tr:first-child{    border-top:1px solid grey; }

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {  display: none; }
.legend{
    margin-bottom:76px;
	margin-left: 50px;
    display:inline-block;
    border-collapse: collapse;
    border-spacing: 0px;
}
.legend td{
    padding:4px 5px;
    vertical-align:bottom;
}
.legendFreq, .legendPerc{
    align:right;
    width:50px;
}
</style>
{% endblock %}

{% block navbar %}{% endblock %}

{% block content %}
<br/><br/>
<div id="content-main">
	<div class="row">
		<!-- Indicator card -->
		<div class="col-lg-4 col-mg-6">
			<div class="panel panel-green">
				<div class="panel-heading">
					<div class="row">
						<div class="col-xs-3">
							<i class="fa fa-tasks fa-5x"></i>
						</div>
						<div class="col-xs-9 text-right">
							<div class="huge">{{ num_indicator }}</div>
							<div class="mid-huge">Indicator</div>
						</div>
					</div>
				</div>
				<a href="{% setting 'ADMIN_ROOT_URL' %}/mhcdashboard/indicator/">
					<div class="panel-footer">
						<span class="pull-left">View All Indicators</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
		</div>
		<!-- Workplan Area card -->
		<div class="col-lg-4 col-mg-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<div class="row">
						<div class="col-xs-3">
							<i class="fa fa-tasks fa-5x"></i>
						</div>
						<div class="col-xs-9 text-right">
							<div class="huge">{{ num_workplanarea }}</div>
							<div class="mid-huge">Workplan Area</div>
						</div>
					</div>
				</div>
				<a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/workplanarea/">
					<div class="panel-footer">
						<span class="pull-left">View All Workplan Areas</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
		</div>
		<!-- MHC Activity card -->
		<div class="col-lg-4 col-mg-6">
			<div class="panel panel-yellow">
				<div class="panel-heading">
					<div class="row">
						<div class="col-xs-3">
							<i class="fa fa-tasks fa-5x"></i>
						</div>
						<div class="col-xs-9 text-right">
							<div class="huge">{{ num_mhcactivity }}</div>
							<div class="mid-huge">MHC Activity</div>
						</div>
					</div>
				</div>
				<a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/mhcactivity/">
					<div class="panel-footer">
						<span class="pull-left">View All MHC Activities</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
		</div>
	</div>
	
	<div class="row">
		<!-- Organization card -->
		<div class="col-lg-4 col-mg-6">
			<div class="panel panel-yellow">
				<div class="panel-heading">
					<div class="row">
						<div class="col-xs-3">
							<i class="fa fa-tasks fa-5x"></i>
						</div>
						<div class="col-xs-9 text-right">
							<div class="huge">{{ num_organization }}</div>
							<div class="mid-huge">Organization</div>
						</div>
					</div>
				</div>
				<a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/organization/">
					<div class="panel-footer">
						<span class="pull-left">View All Organizations</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
		</div>
		<!-- Organization Activity card -->
		<div class="col-lg-4 col-mg-6">
			<div class="panel panel-green">
				<div class="panel-heading">
					<div class="row">
						<div class="col-xs-3">
							<i class="fa fa-tasks fa-5x"></i>
						</div>
						<div class="col-xs-9 text-right">
							<div class="huge">{{ num_orgactivity }}</div>
							<div class="mid-huge">Organization Activity</div>
						</div>
					</div>
				</div>
				<a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/organizationactivity/">
					<div class="panel-footer">
						<span class="pull-left">View All Organization Activities</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
		</div>
		<!-- Output card -->
		<div class="col-lg-4 col-mg-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<div class="row">
						<div class="col-xs-3">
							<i class="fa fa-tasks fa-5x"></i>
						</div>
						<div class="col-xs-9 text-right">
							<div class="huge">{{ num_output }}</div>
							<div class="mid-huge">Output</div>
						</div>
					</div>
				</div>
        {% if user|has_group:"Non-profit Staff" %}
				<a href="{% setting 'ROOT_APP_URL' %}/output/report/">
        {% else %}
        <a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/output/">
        {% endif %}
					<div class="panel-footer">
						<span class="pull-left">View All Outputs</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-green">
				<div class="panel-heading">
					Organization Activity by Quarter
				</div>
				<!-- /.panel-heading -->
				<div class="panel-body">
					<div>
						<div id="bar-pie-chart"></div>
					</div>
					<div class="checkbox">
						<label>
							<input id="bar-pie-chart-1-checkbox" type="checkbox" value="">Show Goal-achieved Activities Only
						</label>
					</div>
				</div>
				<!-- /.panel-body -->
				<a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/organization/">
					<div class="panel-footer">
						<span class="pull-left">View All Organizations</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
			<!-- /.panel -->
		</div>
  </div>
  
  <div class="row">
		<div class="col-lg-12">
			<div class="panel panel-primary">
				<div class="panel-heading">
					Organization Activity by Performance
				</div>
				<!-- /.panel-heading -->
				<div class="panel-body">
					<div>
						<div id="bar-pie-chart2"></div>
					</div>
                    <div>Show Activities in 
						<label>
							<select id="bar-pie-chart-2-select" name="bar-pie-chart-2-select" class="form-control input-sm">
                                <option value="0">2015</option>
                                <option value="1">Q1</option>
                                <option value="2">Q2</option>
                                <option value="3">Q3</option>
                                <option value="4">Q4</option>
                            </select>
                        </label>
					</div>
				</div>
				<!-- /.panel-body -->
				<a href="{% setting 'ADMIN_ROOT_URL' %}/admin/mhcdashboardapp/organization/">
					<div class="panel-footer">
						<span class="pull-left">View All Organizations</span>
						<span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>
						<div class="clearfix"></div>
					</div>
				</a>
			</div>
			<!-- /.panel -->
		</div>
	</div>
	
	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-yellow">
				<div class="panel-heading">
					Activity Goals Not Achieved
				</div>
				<!-- /.panel-heading -->
				<div class="panel-body">
					<div class="dataTable_wrapper">
						<table class="table table-striped table-bordered table-hover" id="data-table">
							<thead>
								<tr>
									<th>Workplan Area</th>
									<th>Organization</th>
									<th>Description</th>
									<th>Output Value</th>
								</tr>
							</thead>
							<tbody>
								{% for op in outputs_goal_no %}
									<tr>
										<td>{{op.orgnization_activity.workplan_area.str_id}}</td>
										<td>{{op.orgnization_activity.organization}}</td>
										<td>{{op.description}}</td>
										<td>{{op.output_value}}</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
				<!-- /.panel-body -->
			</div>
			<!-- /.panel -->
        </div>
	</div>
</div>
{% endblock %}

{% block bottomjs %}
{{ block.super }}
<!--
<script src='{% static "flot/excanvas.min.js"%}'></script>
<script src='{% static "flot/jquery.flot.js"%}'></script>
<script src='{% static "flot/jquery.flot.pie.js"%}'></script>
<script src='{% static "flot.tooltip/js/jquery.flot.tooltip.min.js"%}'></script>
<script>
//Flot Pie Chart Data
$(function() {
    var data = jQuery.parseJSON('{{piechart_data|safe}}');

    var plotObj = $.plot($("#flot-pie-chart"), data, {
        series: {
            pie: {
                show: true
            }
        },
        grid: {
            hoverable: true
        },
        tooltip: true,
        tooltipOpts: {
            content: "%p.0%, %s", // show percentages, rounding to 2 decimal places
            shifts: {
                x: 20,
                y: 0
            },
            defaultTheme: false
        }
    });
});
</script>
-->

<!-- Pie and Bar Tables JavaScript -->
<script src='{% static "d3-3.5.5/d3.min.js" %}'></script>
<script src='{% static "customdashboard/barandpiechart/barandpiechart.js"%}'></script>
<script src='{% static "customdashboard/barandpiechart/barandpiechart2.js"%}'></script>
<script>
var barAndPieChartData1All = jQuery.parseJSON('{{barpiechart_data_1_all|safe}}');
var barAndPieChartData1Goal = jQuery.parseJSON('{{barpiechart_data_1_goal|safe}}');
var barAndPieChartData2 = jQuery.parseJSON('{{barpiechart_data_2|safe}}');
var barAndPieChartData2Q1 = jQuery.parseJSON('{{barpiechart_data_2_q1|safe}}');
var barAndPieChartData2Q2 = jQuery.parseJSON('{{barpiechart_data_2_q2|safe}}');
var barAndPieChartData2Q3 = jQuery.parseJSON('{{barpiechart_data_2_q3|safe}}');
var barAndPieChartData2Q4 = jQuery.parseJSON('{{barpiechart_data_2_q4|safe}}');
dashboard('#bar-pie-chart',barAndPieChartData1All);
dashboard2('#bar-pie-chart2',barAndPieChartData2);

$("#bar-pie-chart-1-checkbox").change(function(){
  if($(this).is(":checked")){
    $("#bar-pie-chart").empty();
    dashboard('#bar-pie-chart',barAndPieChartData1Goal);
  }
  else
  {
    $("#bar-pie-chart").empty();
    dashboard('#bar-pie-chart',barAndPieChartData1All);
  }
});

$("#bar-pie-chart-2-select").change(function(){
    if($("#bar-pie-chart-2-select option:selected").val() == "1"){
        $("#bar-pie-chart2").empty();
        dashboard2('#bar-pie-chart2',barAndPieChartData2Q1);
    }
    else if($("#bar-pie-chart-2-select option:selected").val() == "2"){
        $("#bar-pie-chart2").empty();
        dashboard2('#bar-pie-chart2',barAndPieChartData2Q2);
    }
    else if($("#bar-pie-chart-2-select option:selected").val() == "3"){
        $("#bar-pie-chart2").empty();
        dashboard2('#bar-pie-chart2',barAndPieChartData2Q3);
    }
    else if($("#bar-pie-chart-2-select option:selected").val() == "4"){
        $("#bar-pie-chart2").empty();
        dashboard2('#bar-pie-chart2',barAndPieChartData2Q4);
    }
    else if($("#bar-pie-chart-2-select option:selected").val() == "0"){
        $("#bar-pie-chart2").empty();
        dashboard2('#bar-pie-chart2',barAndPieChartData2);
    }
});
</script>

<!-- Data Tables JavaScript -->
<script src='{% static "datatables/media/js/jquery.dataTables.min.js"%}'></script>
<script src='{% static "datatables-plugins/integration/bootstrap/3/dataTables.bootstrap.min.js"%}'></script>
<script>
$(document).ready(function() {
	$('#data-table').DataTable({
			responsive: true
	});
});
</script>
{% endblock %}